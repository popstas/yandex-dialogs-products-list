# yandex-dialogs-products-list

[![Build Status](https://travis-ci.org/popstas/yandex-dialogs-products-list.svg?branch=master)](https://travis-ci.org/popstas/yandex-dialogs-products-list)

Навык поможет вам вовремя съедать продукты в холодильнике.

Добавляйте каждый продукт со сроком годности.

По умолчанию запускается на *:2757

## Примеры:
- Бананы сегодняшние
- Мандарины испортятся через неделю
- Персики до 28 июля 2019
- Ореховая паста до 26 июня 2019
- Хлеб был куплен в понедельник
- Рожки, сваренные позавчера
- Сосиски с 28 ноября
- Сыр президент прокиснет через неделю
- Молоко прокиснет через 3 дня
- Бельмеши годны до 10 мая
- Куриные грудки закончатся 1 апреля

## Команды:
- Основная команда: добавить продукт и срок окончания
- Скажите "что надо съесть", чтобы добавить новый ответ
- Скажите "команды", чтобы посмотреть примеры
- Можно удалить последний ответ, сказав "удали/забудь последнее"
- Если надо удалить что-то другое, скажите, например, "удали/забудь молоко", или "молоко кончилось"

## Известные проблемы:

## Проблемные фразы:

## Технические особенности
- Сделано на [yandex-dialogs-sdk](https://github.com/fletcherist/yandex-dialogs-sdk), используются commands, scenes, matchers, middlewares из SDK
- Выбор хранилища между MongoDB и Loki (локальное файловое хранилище)
- Выбор сценария на основе простого морфологического разбора
- Система тестирования на основе [сценариев](/static/scenarios.yml), работает на [yandex-dialogs-client](https://github.com/popstas/yandex-dialogs-client) и на [travis](https://travis-ci.org/popstas/yandex-dialogs-products-list)

## Особенности диалога
- Местами есть вариативность ответов
- Умеет отвечать на типичные фразы: приветствие, благодарность, оскорбление
- Пытается понять, что пользователь сказал неправильно и подсказать

## Схема навыка
Попробовал перед написанием кода сначала описать в yaml основные моменты:

``` yaml
Entities:
  date: дата окончания
  product: [молоко, сыр]

  ### Сущности-команды (распознаются)
  remove: [кончилось, прокисло, съел]
  whenEnd: [когда]
  willEnd: [закончится]
  add: [купил, добавь]

### Схема интентов навыка:
Intents:
  addProduct:
    example: купил молоко вчерашнее
    whenEntities: ['product', 'date']
    answer: "${product} закончится ${date}, запомнила"

  removeProduct:
    example: молоко кончилось
    whenEntities: ['product', 'remove']
    answer: "${product} закончится ${date}, запомнила"

  whenEnd:
    example: когда закончится молоко
    whenEntities: ['whenEnd', 'product']
    answer: "${product} закончится послезавтра"

  whatWhen:
    example: что закончится в ближайшие 3 дня
    whenEntities: ['what', 'willEnd', 'date']
    answer: "молоко закончится послезавтра"

  whatEnded:
    example: что закончилось
    whenEntities: ['whenEnd', 'product']
    whenNotEntities: ['date']
    answer: "сыр закончился позавчера"

```